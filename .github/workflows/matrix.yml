name: Projects Matrix

on:
  workflow_dispatch:
    inputs:
      matrix_list:
        description: "List of combinations project+env+region as JSON"
        required: true
        default: >        
          [
            {"project": "1000-5", "env": "dev", "region": "eu-west-1"},
            {"project": "1000-5", "env": "mlops", "region": "eu-west-1"},
            {"project": "1000-5", "env": "prd", "region": "eu-west-1"},
          ]

jobs:
  project-env-matrix:
    runs-on: ubuntu-latest
    strategy:
      max-parallel: 5
      matrix:
        include: ${{ fromJSON(github.event.inputs.matrix_list) }}

    steps:
      - name: Show project and environment
        run: |
          sleep 10
          echo "Project: ${{ matrix.project }}"
          echo "Environment: ${{ matrix.env }}"
          echo "Region: ${{ matrix.region }}"
