name: 50 Projects Matrix

on:
  workflow_dispatch:
    inputs:
      matrix_list:
        description: "Lista de combinaciones project+env como JSON"
        required: true
        default: > 
          [
            {"project": "azmlops-1000-533-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-537-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-538-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-540-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-541-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-541-env-mlops", "env": "mlops", "region": "eu-west-1"},
            {"project": "azmlops-1000-542-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-545-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-549-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-549-env-prd", "env": "prd", "region": "eu-west-1"},
            {"project": "azmlops-1000-550-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-551-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-552-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-552-env-prd", "env": "prd", "region": "eu-west-1"},
            {"project": "azmlops-1000-553-env-dev", "env": "dev", "region": "eu-west-1"},
            {"project": "azmlops-1000-553-env-ppt", "env": "ppt", "region": "eu-west-1"},
            {"project": "azmlops-1000-553-env-prd", "env": "prd", "region": "eu-west-1"},
          ]
                
jobs:
  project-env-matrix:
    runs-on: ubuntu-latest
    strategy:
      max-parallel: 10
      matrix:
        include: ${{ fromJSON(github.event.inputs.matrix_list) }}

    steps:
      - name: Show project and environment
        run: |
          echo "Project: ${{ matrix.project }}"
          echo "Environment: ${{ matrix.env }}"
          echo "Region: ${{ matrix.region }}"
          sleep 1
